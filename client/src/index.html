<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Client</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.2.1.js" integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>
        
  <!-- Latest compiled and minified bootstrap CSS -->
  <!--
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  -->

  <!-- bootswatch -->
  <link rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.min.css">
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <!-- mathjax cdn -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script>
  <!-- mathjs cdn -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.18.1/math.js'></script>

  <script>
    var targets = [];
    function mathtalkInit() {
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});

      $(document).on('DOMNodeInserted', function(event) {
        
        //console.log(event.target.lastElementChild);
        if (event.target.lastElementChild) {
          if (event.target.lastElementChild.id == 'mathtalk-preview-output') {

            //console.log('it happened');
            $('#mathtalk-preview-input').on('change keyup paste', function(event2) {
              //console.log(jQuery._data( event2.target, "events" ));
              document.getElementById('mathtalk-preview-output').innerHTML = document.getElementById('mathtalk-preview-input').value;
              MathJax.Hub.Queue(["Typeset", MathJax.Hub], document.getElementById('mathtalk-preview-output'));
              //$(event2.target).removeClass('mathtalk-preview-output');
            });

          }
        }

        if (document.getElementById('mathtalk-post-body')) {
          if (!($('#mathtalk-post-body').hasClass('mathtalk-finished-rendering'))) {
            $('#mathtalk-post-body').addClass('mathtalk-finished-rendering');
            console.log('found mathtalk-post-body');
            //let the browser finish rendering
            setTimeout(function() {
              MathJax.Hub.Queue(["Typeset", MathJax.Hub], document.getElementById('mathtalk-post-body'));
            }, 500);           
          }
        }

      });

      function findElementWithIdInList(list, element) {

      }
    }    
  </script>

</head>
<body onload="mathtalkInit();">
  <app-root></app-root>
</body>
</html>
